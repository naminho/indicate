/* jQuery Scroll Indicator 2016 by Matthias Giger */
!function(t){t.fn.indicate=function(o){function r(o,r,e,n,s,i,a,l){var c=o.width(),h=r.width();if(a&&!l&&(h=t(r.contents()).width()),c>=h)e.hide(),n.hide(),s.hide(),i.hide();else{if(a&&!l)var d=t(r.contents()).scrollLeft();else var d=o.scrollLeft();n.show(),i.show(),d>25&&(s.show(),e.show())}}function e(o,r,e,n,s,i,a,l,c,h){var d=r.width(),f=e.width();if(o&&!l)var w=t(e.contents()).scrollLeft();if(!o)var w=r.scrollLeft();if(o&&l)var w=c;o&&!l&&(f=t(e.contents()).width()),o&&l&&(f=h),w>25?(i.show(),l||n.show()):(i.hide(),l||n.hide()),f>w+d+25?(a.show(),l||s.show()):(a.hide(),l||s.hide())}function n(o,r,e,n){var s=e.width();n.width();if(r)var i=t(n.contents()).scrollLeft();else var i=e.scrollLeft();var a=s/h.scrollDenominator;r?"left"==o?n.contents().scrollLeft(i-a):n.contents().scrollLeft(i+a):"left"==o?e.animate({scrollLeft:i-a},300):e.animate({scrollLeft:i+a},300)}function s(t){var o=t.split("/");return o[0]}function i(t){var o=t.split("/");o[0];return o[2]}function a(t){var o=t.split(".");return o[o.length-2]+"."+o[o.length-1]}function l(t){var o=t.attr("src"),r=s(o),e=i(o);document.location.hostname;if(location.protocol!=r||location.host!=e){console.warn(location.host+" != "+e),console.warn("indicate will only work on iframes with the same origin.");var n=a(e);if(console.log(document.domain+" != "+n),document.domain!=n)return!0;document.domain=n}return!1}function c(t,o){return Math.floor(Math.random()*(o-t+1))+t}if(0!==this.length){var h=t.extend({},t.fn.indicate.defaults,o),d=c(1,999);return this.each(function(o){var s,a,c,f,w,p,u,v,g,m,x=!1;if(t(this).parent().hasClass("content-wrapper")){var m=t(this).parent().parent();return t(".fade-left",m).css("box-shadow","0 0 30px 20px "+h.color),t(".fade-right",m).css("box-shadow","0 0 30px 20px "+h.color),void(h.arrows?("none"===t(".arrow-left",m).css("display")&&console.log("TODO add arrows (separate function)"),h.arrows===!0&&(t(".arrow-left",m).show(),t(".arrow-right",m).show())):(t(".arrow-left",m).hide(),t(".arrow-right",m).hide()))}s=t(this),s.css("width","100%"),s.wrap('<div class="scroll-indicator plugin-wrapper nr'+d+"_"+o+'"><div class="content-wrapper nr'+d+"_"+o+'"></div><div class="fade-left nr'+d+"_"+o+'"></div><div class="fade-right nr'+d+"_"+o+'"></div></div>'),m=t(".plugin-wrapper.nr"+d+"_"+o,s.parent().parent().parent()),g=t(".content-wrapper.nr"+d+"_"+o,m),f=t(".fade-left.nr"+d+"_"+o,m),c=t(".fade-right.nr"+d+"_"+o,m),v=s.prop("tagName").toLowerCase(),u="iframe"==s.prop("tagName").toLowerCase(),h.maxHeight&&g.css("max-height",h.maxHeight),u&&(x=l(s)),m.css({position:"relative",overflow:"hidden"}),g.css({position:"relative","overflow-x":"auto"});var L={"z-index":"1",width:"0px",height:"100%",position:"absolute",top:"0"},_={"box-shadow":"0 0 30px 20px "+h.color};if(f.css(L).css("left","0").css(_).css("display","none"),c.css(L).css("right","0").css(_),h.arrows){var k='<svg class="arrow-left nr'+d+"_"+o+'" width="24" height="24" xmlns="http://www.w3.org/2000/svg"><polyline fill="none" stroke="#666666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" points="12,22 2,12 12,2 "/></svg>',y='<svg class="arrow-right nr'+d+"_"+o+'" width="24" height="24" xmlns="http://www.w3.org/2000/svg"><polyline fill="none" stroke="#666666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" points="12,22 22,12 12,2 "/></svg>';m.append(k),m.append(y),arrowStyles={width:"24px",height:"24px",position:"absolute",top:"10px","z-index":"120"},p=t(".arrow-left.nr"+d+"_"+o,a).css(arrowStyles).css("margin-left","2px").css("display","none"),w=t(".arrow-right.nr"+d+"_"+o,a).css(arrowStyles).css("right","0").css("margin-right","2px"),p.click(function(){x||n("left",u,g,s)}),w.click(function(){x||n("right",u,g,s)})}if(g.attr("unselectable","on").css("user-select","none").on("selectstart",!1),t(window).on("resize",function(){r(g,s,f,c,p,w,u,x)}),u&&!x?setTimeout(function(){t(s.contents()).scroll(function(){e(u,g,s,p,w,f,c,x)}),r(g,s,f,c,p,w,u,x)},3e3):g.on("scroll",function(){e(u,g,s,p,w,f,c,x)}),x){var b=s.attr("src"),F=i(b);t.receiveMessage(function(t){var o=JSON.parse(t.data);e(u,g,s,p,w,f,c,x,o.offset,o.width)},"http://"+F)}r(g,s,f,c,p,w,u,x)}),this}},t.fn.indicate.defaults={scrollDenominator:3,color:"#FFFFFF",arrows:!0}}(jQuery);